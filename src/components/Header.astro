---
/**
 * Header Component - Global Navigation
 *
 * Design:
 * - Glass morphism on scroll
 * - Supports all theme modes
 * - Mobile-responsive with hamburger menu
 */

import ThemeSwitcher from './ui/ThemeSwitcher';

const navLinks = [
  { label: 'Features', href: '/#features' },
  { label: 'Use Cases', href: '/#use-cases' },
  { label: 'Blog', href: '/blog/' },
  { label: 'Docs', href: '/docs/' },
  { label: 'GitHub', href: 'https://github.com/code-sensei/artemiskit', external: true },
];
---

<header
  id="header"
  class="fixed top-0 left-0 right-0 z-50"
>
  <div class="header-inner transition-all duration-300">
    <div class="container">
      <nav class="flex items-center justify-between h-16 md:h-18">

        <!-- Logo -->
        <a href="/" class="flex items-center gap-2.5 group">
          <img
            src="/artemiskit-logo.png"
            alt="ArtemisKit - Open Source LLM Testing Toolkit"
            class="h-7 w-auto transition-opacity duration-200 group-hover:opacity-80"
            width="120"
            height="28"
            loading="eager"
          />
        </a>

        <!-- Desktop Navigation -->
        <div class="hidden md:flex items-center gap-1">

          <!-- Nav Links -->
          <ul class="flex items-center">
            {navLinks.map((link) => (
              <li>
                <a
                  href={link.href}
                  class="nav-link flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-[var(--theme-text-tertiary)] hover:text-[var(--theme-text-primary)] rounded-lg hover:bg-[var(--theme-bg-tertiary)] transition-colors"
                  {...(link.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
                >
                  <span>{link.label}</span>
                  {link.external && (
                    <svg class="w-3 h-3 opacity-50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M7 17L17 7M17 7H7M17 7V17" />
                    </svg>
                  )}
                </a>
              </li>
            ))}
          </ul>

          <!-- Divider -->
          <div class="w-px h-5 bg-[var(--theme-border)] mx-3"></div>

          <!-- Actions -->
          <div class="flex items-center gap-2">
            <ThemeSwitcher client:load variant="compact" />

            <a
              href="/docs/cli/getting-started/"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-to-b from-orange-500 to-orange-600 text-white text-sm font-semibold shadow-sm shadow-orange-500/20 hover:from-orange-400 hover:to-orange-500 hover:shadow-orange-500/30 transition-all duration-200"
            >
              <span>Get Started</span>
            </a>
          </div>
        </div>

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-button"
          class="md:hidden flex items-center justify-center w-10 h-10 rounded-lg text-[var(--theme-text-tertiary)] hover:text-[var(--theme-text-primary)] hover:bg-[var(--theme-bg-tertiary)] transition-colors"
          aria-label="Toggle menu"
          aria-expanded="false"
        >
          <svg class="w-5 h-5 menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <line x1="4" y1="6" x2="20" y2="6" />
            <line x1="4" y1="12" x2="20" y2="12" />
            <line x1="4" y1="18" x2="20" y2="18" />
          </svg>
          <svg class="w-5 h-5 close-icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
        </button>
      </nav>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="mobile-menu md:hidden hidden absolute top-full left-0 right-0 bg-[var(--theme-bg-overlay)] backdrop-blur-xl border-b border-[var(--theme-border)]"
  >
    <div class="container py-4">
      <ul class="space-y-1">
        {navLinks.map((link) => (
          <li>
            <a
              href={link.href}
              class="flex items-center justify-between px-4 py-3 text-base text-[var(--theme-text-secondary)] hover:text-[var(--theme-text-primary)] hover:bg-[var(--theme-bg-tertiary)] rounded-xl transition-colors"
              {...(link.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
            >
              <span>{link.label}</span>
              {link.external && (
                <svg class="w-4 h-4 opacity-40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M7 17L17 7M17 7H7M17 7V17" />
                </svg>
              )}
            </a>
          </li>
        ))}
      </ul>

      <div class="mt-4 pt-4 border-t border-[var(--theme-border)]">
        <div class="flex items-center justify-between mb-4 px-4">
          <span class="text-sm text-[var(--theme-text-muted)]">Appearance</span>
          <ThemeSwitcher client:load />
        </div>

        <a
          href="/docs/cli/getting-started/"
          class="flex items-center justify-center gap-2 w-full px-4 py-3 rounded-xl bg-gradient-to-b from-orange-500 to-orange-600 text-white font-semibold"
        >
          <span>Get Started</span>
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</header>

<style>
  .header-inner {
    background: transparent;
  }

  #header.scrolled .header-inner {
    background: var(--theme-header-bg);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border-bottom: 1px solid var(--theme-border-subtle);
  }

  @media (prefers-reduced-motion: reduce) {
    .header-inner {
      transition: none;
    }
  }
</style>

<script>
  const header = document.getElementById('header');
  let ticking = false;

  const updateHeader = () => {
    const currentScroll = window.scrollY;
    if (currentScroll > 10) {
      header?.classList.add('scrolled');
    } else {
      header?.classList.remove('scrolled');
    }
    ticking = false;
  };

  const handleScroll = () => {
    if (!ticking) {
      requestAnimationFrame(updateHeader);
      ticking = true;
    }
  };

  window.addEventListener('scroll', handleScroll, { passive: true });
  updateHeader();

  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = mobileMenuButton?.querySelector('.menu-icon');
  const closeIcon = mobileMenuButton?.querySelector('.close-icon');

  mobileMenuButton?.addEventListener('click', () => {
    const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
    mobileMenuButton.setAttribute('aria-expanded', String(!isExpanded));
    mobileMenu?.classList.toggle('hidden');
    menuIcon?.classList.toggle('hidden');
    closeIcon?.classList.toggle('hidden');
  });

  // Close mobile menu on link click
  mobileMenu?.querySelectorAll('a').forEach((link) => {
    link.addEventListener('click', () => {
      mobileMenuButton?.setAttribute('aria-expanded', 'false');
      mobileMenu?.classList.add('hidden');
      menuIcon?.classList.remove('hidden');
      closeIcon?.classList.add('hidden');
    });
  });
</script>
